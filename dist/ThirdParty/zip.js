/*! For license information please see zip.js.LICENSE.txt */
import buildModuleUrl from"../Core/buildModuleUrl.js";var tmp={};!function(e){var t,n,i="File format is not recognized.",r="Error while reading zip file.",o="Error while reading file data.",a=524288,f="text/plain",c="message";try{t=0===new Blob([new DataView(new ArrayBuffer(0))]).size}catch(W){}function u(){var e=-1,t=this;t.append=function(n){var i,r=t.table;for(i=0;i<n.length;i++)e=e>>>8^r[255&(e^n[i])]},t.get=function(){return~e}}function s(e,t){var n,i;return n=new ArrayBuffer(e),i=new Uint8Array(n),t&&i.set(t,0),{buffer:n,array:i,view:new DataView(n)}}function l(){}function g(e){var t,n=this;n.size=0,n.init=function(i,r){var o=new Blob([e],{type:f});(t=new d(o)).init((function(){n.size=t.size,i()}),r)},n.readUint8Array=function(e,n,i,r){t.readUint8Array(e,n,i,r)}}function w(e){var t,n=this;n.size=0,n.init=function(i){for(var r=e.length;"="==e.charAt(r-1);)r--;t=e.indexOf(",")+1,n.size=Math.floor(.75*(r-t)),i()},n.readUint8Array=function(n,i,r){var o,a=s(i),f=4*Math.floor(n/3),c=4*Math.ceil((n+i)/3),u=window.atob(e.substring(f+t,c+t)),l=n-3*Math.floor(f/4);for(o=l;o<l+i;o++)a.array[o-l]=u.charCodeAt(o);r(a.array)}}function d(e){var t=this;t.size=0,t.init=function(t){this.size=e.size,t()},t.readUint8Array=function(t,n,i,r){var o=new FileReader;o.onload=function(e){i(new Uint8Array(e.target.result))},o.onerror=r,o.readAsArrayBuffer(function(e,t,n){return e.slice?e.slice(t,t+n):e.webkitSlice?e.webkitSlice(t,t+n):e.mozSlice?e.mozSlice(t,t+n):e.msSlice?e.msSlice(t,t+n):void 0}(e,t,n))}}function v(){}function h(e){var n,i=this;i.init=function(e){n=new Blob([],{type:f}),e()},i.writeUint8Array=function(e,i){n=new Blob([n,t?e:e.buffer],{type:f}),i()},i.getData=function(t,i){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=i,r.readAsText(n,e)}}function p(e){var t=this,n="",i="";t.init=function(t){n+="data:"+(e||"")+";base64,",t()},t.writeUint8Array=function(e,t){var r,o=i.length,a=i;for(i="",r=0;r<3*Math.floor((o+e.length)/3)-o;r++)a+=String.fromCharCode(e[r]);for(;r<e.length;r++)i+=String.fromCharCode(e[r]);a.length>2?n+=window.btoa(a):i=a,t()},t.getData=function(e){e(n+window.btoa(i))}}function y(e){var n,i=this;i.init=function(t){n=new Blob([],{type:e}),t()},i.writeUint8Array=function(i,r){n=new Blob([n,t?i:i.buffer],{type:e}),r()},i.getData=function(e){e(n)}}function U(e,t,n,i,r,o,f,u,s,l){var g,w,d=0;function v(){e.removeEventListener(c,h,!1),u(w)}function h(e){var t=e.data,i=t.data;t.onappend&&(w+=i.length,n.writeUint8Array(i,(function(){o(!1,i),p()}),l)),t.onflush&&(i?(w+=i.length,n.writeUint8Array(i,(function(){o(!1,i),v()}),l)):v()),t.progress&&f&&f(g+t.current,r)}function p(){(g=d*a)<r?t.readUint8Array(i+g,Math.min(a,r-g),(function(t){e.postMessage({append:!0,data:t}),d++,f&&f(g,r),o(!0,t)}),s):e.postMessage({flush:!0})}w=0,e.addEventListener(c,h,!1),p()}function m(e,t,n,i,r,o,f,c,u,s){var l,g=0,w=0;!function d(){var v;(l=g*a)<r?t.readUint8Array(i+l,Math.min(a,r-l),(function(t){var a=e.append(t,(function(){f&&f(i+l,r)}));w+=a.length,o(!0,t),n.writeUint8Array(a,(function(){o(!1,a),g++,setTimeout(d,1)}),s),f&&f(l,r)}),u):(v=e.flush())?(w+=v.length,n.writeUint8Array(v,(function(){o(!1,v),c(w)}),s)):c(w)}()}function z(e,t,n,i,r,o,f,c,s){var l=0,g=new u;!function u(){var w=l*a;w<i?e.readUint8Array(n+w,Math.min(a,i-w),(function(e){r&&g.append(e),f&&f(w,i,e),t.writeUint8Array(e,(function(){l++,u()}),s)}),c):o(i,g.get())}()}function A(e){var t,n,i="",r=["\xc7","\xfc","\xe9","\xe2","\xe4","\xe0","\xe5","\xe7","\xea","\xeb","\xe8","\xef","\xee","\xec","\xc4","\xc5","\xc9","\xe6","\xc6","\xf4","\xf6","\xf2","\xfb","\xf9","\xff","\xd6","\xdc","\xf8","\xa3","\xd8","\xd7","\u0192","\xe1","\xed","\xf3","\xfa","\xf1","\xd1","\xaa","\xba","\xbf","\xae","\xac","\xbd","\xbc","\xa1","\xab","\xbb","_","_","_","\xa6","\xa6","\xc1","\xc2","\xc0","\xa9","\xa6","\xa6","+","+","\xa2","\xa5","+","+","-","-","+","-","+","\xe3","\xc3","+","+","-","-","\xa6","-","+","\xa4","\xf0","\xd0","\xca","\xcb","\xc8","i","\xcd","\xce","\xcf","+","+","_","_","\xa6","\xcc","_","\xd3","\xdf","\xd4","\xd2","\xf5","\xd5","\xb5","\xfe","\xde","\xda","\xdb","\xd9","\xfd","\xdd","\xaf","\xb4","\xad","\xb1","_","\xbe","\xb6","\xa7","\xf7","\xb8","\xb0","\xa8","\xb7","\xb9","\xb3","\xb2","_"," "];for(t=0;t<e.length;t++)i+=(n=255&e.charCodeAt(t))>127?r[n-128]:String.fromCharCode(n);return i}function b(e){return decodeURIComponent(escape(e))}function M(e){var t,n="";for(t=0;t<e.length;t++)n+=String.fromCharCode(e[t]);return n}function S(e,t,n,i,r){e.version=t.view.getUint16(n,!0),e.bitFlag=t.view.getUint16(n+2,!0),e.compressionMethod=t.view.getUint16(n+4,!0),e.lastModDateRaw=t.view.getUint32(n+6,!0),e.lastModDate=function(e){var t=(4294901760&e)>>16,n=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&n)>>11,(2016&n)>>5,2*(31&n),0)}catch(W){}}(e.lastModDateRaw),1!==(1&e.bitFlag)?((i||8!=(8&e.bitFlag))&&(e.crc32=t.view.getUint32(n+10,!0),e.compressedSize=t.view.getUint32(n+14,!0),e.uncompressedSize=t.view.getUint32(n+18,!0)),4294967295!==e.compressedSize&&4294967295!==e.uncompressedSize?(e.filenameLength=t.view.getUint16(n+22,!0),e.extraFieldLength=t.view.getUint16(n+24,!0)):r("File is using Zip64 (4gb+ file size).")):r("File contains encrypted entry.")}function D(t,n){function a(){}function f(e,i){t.readUint8Array(t.size-e,e,(function(t){var n=s(t.length,t).view;1347093766!=n.getUint32(0)?f(e+1,i):i(n)}),(function(){n(r)}))}return a.prototype.getData=function(r,a,f,c){var l,g=this;function w(e,t){l&&l.terminate(),l=null,e&&e(t)}function d(e,t){c&&!function(e){var t=s(4);return t.view.setUint32(0,e),g.crc32==t.view.getUint32(0)}(t)?v():r.getData((function(e){w(a,e)}))}function v(){w(n,o)}function h(){w(n,"Error while writing file data.")}t.readUint8Array(g.offset,30,(function(o){var a,w=s(o.length,o);1347093252==w.view.getUint32(0)?(S(g,w,4,!1,n),a=g.offset+30+g.filenameLength+g.extraFieldLength,r.init((function(){0===g.compressionMethod?z(t,r,a,g.compressedSize,c,d,f,v,h):l=function(t,n,i,r,o,a,f,c,s){var l,g=new u;function w(e,t){o&&!e&&g.append(t)}function d(e){a(e,g.get())}return e.zip.useWebWorkers?U(l=new Worker(e.zip.workerScriptsPath+"inflate.js"),t,n,i,r,w,f,d,c,s):m(new e.zip.Inflater,t,n,i,r,w,f,d,c,s),l}(t,r,a,g.compressedSize,c,d,f,v,h)}),h)):n(i)}),v)},{getEntries:function(e){t.size<22?n(i):f(22,(function(o){var f,c;f=o.getUint32(16,!0),c=o.getUint16(8,!0),t.readUint8Array(f,t.size-f,(function(t){var r,o,f,u,l=0,g=[],w=s(t.length,t);for(r=0;r<c;r++){if(o=new a,1347092738!=w.view.getUint32(l))return void n(i);S(o,w,l+6,!0,n),o.commentLength=w.view.getUint16(l+32,!0),o.directory=16==(16&w.view.getUint8(l+38)),o.offset=w.view.getUint32(l+42,!0),f=M(w.array.subarray(l+46,l+46+o.filenameLength)),o.filename=2048===(2048&o.bitFlag)?b(f):A(f),o.directory||"/"!=o.filename.charAt(o.filename.length-1)||(o.directory=!0),u=M(w.array.subarray(l+46+o.filenameLength+o.extraFieldLength,l+46+o.filenameLength+o.extraFieldLength+o.commentLength)),o.comment=2048===(2048&o.bitFlag)?b(u):A(u),g.push(o),l+=46+o.filenameLength+o.extraFieldLength+o.commentLength}e(g)}),(function(){n(r)}))}))},close:function(e){e&&e()}}}function L(e){return unescape(encodeURIComponent(e))}function F(e){var t,n=[];for(t=0;t<e.length;t++)n.push(e.charCodeAt(t));return n}function C(t,n,i){var r,a={},f=[],l=0;function g(e,t){r&&r.terminate(),r=null,e&&e(t)}function w(){g(n,"Error while writing zip file.")}function d(){g(n,o)}return{add:function(o,v,h,p,y){var A,b,M;function S(e,n){var i=s(16);l+=e||0,i.view.setUint32(0,1347094280),"undefined"!=typeof n&&(A.view.setUint32(10,n,!0),i.view.setUint32(4,n,!0)),v&&(i.view.setUint32(8,e,!0),A.view.setUint32(14,e,!0),i.view.setUint32(12,v.size,!0),A.view.setUint32(18,v.size,!0)),t.writeUint8Array(i.array,(function(){l+=16,g(h)}),w)}function D(){y=y||{},o=o.trim(),y.directory&&"/"!=o.charAt(o.length-1)&&(o+="/"),a.hasOwnProperty(o)?n("File already exists."):(b=F(L(o)),f.push(o),function(e){var n;M=y.lastModDate||new Date,A=s(26),a[o]={headerArray:A.array,directory:y.directory,filename:b,offset:l,comment:F(L(y.comment||""))},A.view.setUint32(0,335546376),y.version&&A.view.setUint8(0,y.version),i||0===y.level||y.directory||A.view.setUint16(4,2048),A.view.setUint16(6,(M.getHours()<<6|M.getMinutes())<<5|M.getSeconds()/2,!0),A.view.setUint16(8,(M.getFullYear()-1980<<4|M.getMonth()+1)<<5|M.getDate(),!0),A.view.setUint16(22,b.length,!0),(n=s(30+b.length)).view.setUint32(0,1347093252),n.array.set(A.array,4),n.array.set(b,30),l+=n.array.length,t.writeUint8Array(n.array,e,w)}((function(){v?i||0===y.level?z(v,t,0,v.size,!0,S,p,d,w):r=function(t,n,i,r,o,a,f){var s,l=new u;function g(e,t){e&&l.append(t)}function w(e){r(e,l.get())}return e.zip.useWebWorkers?((s=new Worker(e.zip.workerScriptsPath+"deflate.js")).addEventListener(c,(function e(){s.removeEventListener(c,e,!1),U(s,t,n,0,t.size,g,o,w,a,f)}),!1),s.postMessage({init:!0,level:i})):m(new e.zip.Deflater,t,n,0,t.size,g,o,w,a,f),s}(v,t,y.level,S,p,d,w):S()})))}v?v.init(D,d):D()},close:function(e){var n,i,r,o=0,c=0;for(i=0;i<f.length;i++)o+=46+(r=a[f[i]]).filename.length+r.comment.length;for(n=s(o+22),i=0;i<f.length;i++)r=a[f[i]],n.view.setUint32(c,1347092738),n.view.setUint16(c+4,5120),n.array.set(r.headerArray,c+6),n.view.setUint16(c+32,r.comment.length,!0),r.directory&&n.view.setUint8(c+38,16),n.view.setUint32(c+42,r.offset,!0),n.array.set(r.filename,c+46),n.array.set(r.comment,c+46+r.filename.length),c+=46+r.filename.length+r.comment.length;n.view.setUint32(c,1347093766),n.view.setUint16(c+8,f.length,!0),n.view.setUint16(c+10,f.length,!0),n.view.setUint32(c+12,o,!0),n.view.setUint32(c+16,l,!0),t.writeUint8Array(n.array,(function(){g((function(){t.getData(e)}))}),w)}}}u.prototype.table=function(){var e,t,n,i=[];for(e=0;e<256;e++){for(n=e,t=0;t<8;t++)1&n?n=n>>>1^3988292384:n>>>=1;i[e]=n}return i}(),g.prototype=new l,g.prototype.constructor=g,w.prototype=new l,w.prototype.constructor=w,d.prototype=new l,d.prototype.constructor=d,v.prototype.getData=function(e){e(this.data)},h.prototype=new v,h.prototype.constructor=h,p.prototype=new v,p.prototype.constructor=p,y.prototype=new v,y.prototype.constructor=y,e.zip={Reader:l,Writer:v,BlobReader:d,Data64URIReader:w,TextReader:g,BlobWriter:y,Data64URIWriter:p,TextWriter:h,createReader:function(e,t,n){e.init((function(){t(D(e,n))}),n)},createWriter:function(e,t,n,i){e.init((function(){t(C(e,n,i))}),n)},useWebWorkers:!0},Object.defineProperties(e.zip,{workerScriptsPath:{get:function(){return"undefined"===typeof n&&(n=buildModuleUrl("ThirdParty/Workers/")),n}}})}(tmp);export default tmp.zip;