import measureText from"../ThirdParty/measureText.js";import Color from"./Color.js";import defaultValue from"./defaultValue.js";import defined from"./defined.js";import DeveloperError from"./DeveloperError.js";var imageSmoothingEnabledName;function writeTextToCanvas(e,o){if(!defined(e))throw new DeveloperError("text is required.");if(""!==e){o=defaultValue(o,defaultValue.EMPTY_OBJECT);var t=defaultValue(o.font,"10px sans-serif"),i=defaultValue(o.stroke,!1),a=defaultValue(o.fill,!0),l=defaultValue(o.strokeWidth,1),n=defaultValue(o.backgroundColor,Color.TRANSPARENT),d=defaultValue(o.padding,0),r=2*d,m=document.createElement("canvas");m.width=1,m.height=1,m.style.font=t;var f=m.getContext("2d");defined(imageSmoothingEnabledName)||(defined(f.imageSmoothingEnabled)?imageSmoothingEnabledName="imageSmoothingEnabled":defined(f.mozImageSmoothingEnabled)?imageSmoothingEnabledName="mozImageSmoothingEnabled":defined(f.webkitImageSmoothingEnabled)?imageSmoothingEnabledName="webkitImageSmoothingEnabled":defined(f.msImageSmoothingEnabled)&&(imageSmoothingEnabledName="msImageSmoothingEnabled")),f.font=t,f.lineJoin="round",f.lineWidth=l,f[imageSmoothingEnabledName]=!1,f.textBaseline=defaultValue(o.textBaseline,"bottom"),m.style.visibility="hidden",document.body.appendChild(m);var g=measureText(f,e,i,a);m.dimensions=g,document.body.removeChild(m),m.style.visibility="";var u=-g.bounds.minx,s=Math.ceil(g.width)+u+r,h=g.height+r,b=h-(h-g.ascent+d)+r;if(m.width=s,m.height=h,f.font=t,f.lineJoin="round",f.lineWidth=l,f[imageSmoothingEnabledName]=!1,n!==Color.TRANSPARENT&&(f.fillStyle=n.toCssColorString(),f.fillRect(0,0,m.width,m.height)),i){var E=defaultValue(o.strokeColor,Color.BLACK);f.strokeStyle=E.toCssColorString(),f.strokeText(e,u+d,b)}if(a){var S=defaultValue(o.fillColor,Color.WHITE);f.fillStyle=S.toCssColorString(),f.fillText(e,u+d,b)}return m}}export default writeTextToCanvas;